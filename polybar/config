;=====================================================
;
;   To learn more about how to configure Polybar
;   go to https://github.com/jaagr/polybar
;
;   The README contains alot of information
;
;=====================================================
; https://fontawesome.com/cheatsheet

[colors]
    background = ${xrdb:color1}
    background-alt = ${xrdb:color0}
    foreground = ${xrdb:color0}
    foreground-alt = ${xrdb:color0}
    marked = ${xrdb:color2:#222}
    primary = ${colors.foreground}
    secondary = ${colors.background}
    alert = ${colors.foreground}

    focused-tab = ${xrdb:color6}
    focused-tab-color = ${xrdb:color1}
    focused-tab-underline = ${xrdb:color1}
    red = #FF0000

[bar/ivbuch]
    monitor = ${env:MONITOR}
    bottom = false
    width = 100%
    height = 40
    offset-x = 0%
    offset-y = 0%
    fixed-center = false
    dim-value = 0.5

    ; background = ${colors.background}
    background =  #ddff10599
    foreground = ${colors.foreground}

    line-size = 2
    line-color = ${colors.foreground}

    border-size = 14
    border-top-size = 10
    border-bottom-size = 0
    border-color = #00000000

    underline-size = 0

    padding-left = 0
    padding-right = 2

    module-margin-left = 1
    module-margin-right = 1

    font-0 = Share-TechMono:pixelsize=16
    font-1 = FontAwesome:size=14

    modules-left = i3
    modules-center = 
    modules-right = time-local separator battery separator time-moscow separator powermenu xkeyboard separator vpn docker separator mail

    tray-position = right
    tray-padding = 2
    tray-transparent = true
    ;tray-background = #0063ff

    wm-restack = i3

    cursor-click = pointer
    cursor-scroll = ns-resize

[module/xwindow]
    type = internal/xwindow
    label = %title:0:30:...%

[module/xkeyboard]
    type = internal/xkeyboard
    blacklist-0 = num lock

    format = <label-layout> <label-indicator>
    format-spacing = 0

    format-prefix = " "
    format-prefix-underline = ${colors.secondary}

    label-layout =  %layout%
    label-layout-underline = ${colors.secondary}

    label-indicator-padding = 2
    label-indicator-margin = 1
    label-indicator-background = ${colors.background}
    label-indicator-underline = ${colors.secondary}

    label-unmounted-foreground = ${colors.foreground-alt}

[module/bspwm]
    type = internal/bspwm

    label-focused = %name%
    label-focused-background = #FFF
    label-focused-underline= ${colors.primary}
    label-focused-padding = 1

    label-occupied = %name%
    label-occupied-padding = 2

    label-urgent = %name%!
    label-urgent-background = ${colors.alert}
    label-urgent-padding = 2

    label-empty = %name%
    label-empty-foreground = ${colors.foreground-alt}
    label-empty-padding = 2

[module/i3]
    type = internal/i3
    format = <label-state> <label-mode>
    index-sort = true
    wrapping-scroll = true
    strip-wsnumbers = false
    fuzzy-match = true
    default-label = %icon% %name%
    default-padding = 2

    ws-icon-0 = terminal;
    ws-icon-1 = ide;
    ws-icon-2 = www;
    ws-icon-3 = mutt;
    ws-icon-4 = chats;
    ws-icon-5 = vim;
    ws-icon-default = 

    ; Only show workspaces on the same output as the bar
    pin-workspaces = true

    label-mode-padding = ${self.default-padding}
    label-mode-foreground = ${colors.focused-tab-color}
    label-mode-background = ${colors.primary}

    ; focused = Active workspace on focused monitor
    label-focused = ${self.default-label}
    label-focused-foreground = ${colors.focused-tab-color}
    label-focused-background = ${colors.background-alt}
    label-focused-underline = ${colors.focused-tab-underline}
    label-focused-padding = ${self.default-padding}

    ; unfocused = Inactive workspace on any monitor
    label-unfocused = ${self.default-label}
    label-unfocused-padding = ${self.default-padding}
    ; label-unfocused-background = ${colors.red}

    ; visible = Active workspace on unfocused monitor
    label-visible = ${self.default-label}
    label-visible-background = ${colors.background-alt}
    label-visible-foreground = ${colors.background}
    label-visible-underline = ${self.label-focused-underline}
    label-visible-padding = ${self.default-padding}

    ; urgent = Workspace with urgency hint set
    label-urgent = ${self.default-label}
    label-urgent-foreground = ${colors.foreground}
    ; label-urgent-background = ${colors.background}
    label-urgent-padding = ${self.default-padding}

    label-separator = 
    label-separator-padding = ${self.default-padding}
    label-separator-foreground = ${colors.foreground}

[module/time-local]
    type = internal/date
    interval = 5

    date = %m/%d/%Y

    time =   %H:%M

    format-prefix = 
    format-prefix-foreground = ${colors.foreground-alt}

    label =  %date% %time%

[module/volume]
    type = internal/volume
    speaker-mixer = Speaker
    headphone-mixer = Headphone
    headphone-id = 9

    format-volume = <label-volume> <bar-volume>
    label-volume = VOL
    label-volume-foreground = ${root.foreground}

    format-muted-prefix = " "
    format-muted-foreground = ${colors.foreground-alt}
    label-muted = Sound muted

    bar-volume-width = 7
    bar-volume-foreground-0 = #55aa55
    bar-volume-foreground-1 = #55aa55
    bar-volume-foreground-2 = #55aa55
    bar-volume-foreground-3 = #55aa55
    bar-volume-foreground-4 = #55aa55
    bar-volume-foreground-5 = #f5a70a
    bar-volume-foreground-6 = #ff5555
    bar-volume-gradient = false
    bar-volume-indicator = |
    bar-volume-indicator-font = 2
    bar-volume-fill = ─
    bar-volume-fill-font = 2
    bar-volume-empty = ─
    bar-volume-empty-font = 2
    bar-volume-empty-foreground = ${colors.foreground-alt}

[module/battery]
    type = internal/battery
    battery = BAT0
    adapter = AC
    full-at = 98

    format-charging = <animation-charging> <label-charging>
    label-charging = %percentage%% 

    format-discharging = <ramp-capacity> <label-discharging>
    label-discharging = %percentage%%

    label-full = %percentage: 4%%
    format-full = <label-full>
    format-full-prefix =  
    format-full-prefix-foreground = ${colors.foreground}

    ramp-capacity-0 =  %{B#FF0000} {F-}
    ramp-capacity-1 =   
    ramp-capacity-2 =   

    animation-charging-0 =  
    animation-charging-1 =   
    animation-charging-2 =  
    animation-charging-framerate = 750

    format-full-padding = 1
    format-charging-padding = 1
    format-discharging-padding = 1

[settings]
screenchange-reload = true
;compositing-background = xor
;compositing-background = screen
;compositing-foreground = source
;compositing-border = over

[global/wm]
margin-top = 5
margin-bottom = 5
; vim:ft=dosini

[module/separator]
type = custom/text
content = |
content-foreground = ${colors.alert}

[module/time-moscow]
type = custom/script
exec = TZ=Europe/Moscow date +" %H:%M"
interval = 30

[module/vpn]
type = custom/script
exec = echo " VPN ON "
exec-if = pgrep -x openvpn
interval = 3
label = %output%
label-background = ${colors.red}
format = <label> |

[module/docker]
type = custom/script
exec = /my-tools/dotfiles/polybar/docker-module.sh
interval = 3
label = %output%
format = <label>

[module/mail]
type = custom/script
exec = python /my-tools/home-infostructure/work/medfusion/get-unread-mail.py
interval = 30
label = %output%
format = <label>
