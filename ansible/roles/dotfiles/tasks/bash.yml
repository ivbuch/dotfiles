- name: check oh-my-zsh install
  stat:
    path: ~/.oh-my-zsh
  register: oh_my_zsh_register

- name: Cloning  oh-my-zsh
  git:
    repo=https://github.com/robbyrussell/oh-my-zsh
    dest=~/.oh-my-zsh
  when: oh_my_zsh_register.stat.exists == false
  register: cloning

- name: Creating new ~/.zshrc
  copy:
    src=~/.oh-my-zsh/templates/zshrc.zsh-template
    dest=~/.zshrc
  when: cloning|success

- name: Set zsh default shell
  shell: chsh -s $(which zsh) igor
  become: yes

- name: touch .zshrc file
  file: 
    dest: "{{ ansible_env.HOME }}/.zshrc"
    state: touch
  register: touch_log
  changed_when: touch_log.diff.before.state != "file"

- name: create .bash_aliases file if not exists
  file: 
    dest: "{{ ansible_env.HOME }}/.bash_aliases"
    state: touch
  register: touch_log
  changed_when: touch_log.diff.before.state != "file"

- name: Source custom bash aliases file
  lineinfile:
    path: "{{ ansible_env.HOME }}/.bash_aliases"
    line: "{{ item }}"
    state: present
  with_items:
    - "source {{ mytools_path }}/dotfiles/bash/bash_aliases.sh"
    - "source {{ mytools_path }}/home-infostructure/bash-scripts/work/bash_aliases.sh"
    - "source {{ mytools_path }}/home-infostructure/bash-scripts/work/bash_functions.sh"

- name: .zshrc must source aliases and python main virtual-env
  lineinfile:
    path: "{{ ansible_env.HOME }}/.zshrc"
    line: "source /my-tools/dotfiles/bash/zshrc.sh"
    state: present
